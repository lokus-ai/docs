# Database Views (Bases)

Bases in Lokus bring structured database functionality to your notes, allowing you to organize, filter, and visualize information in multiple views. Think of Bases as lightweight databases that live alongside your markdown notes, providing spreadsheet-like power without leaving your knowledge base.

**Version:** 1.3.1 | **Status:** Production Ready

## Overview

Bases transform collections of notes into structured data that can be viewed as tables, cards, galleries, calendars, or lists. Each Base is a special note that aggregates other notes based on criteria you define, displaying them with customizable properties and views. **Your notes remain standard markdown files** - Bases simply provide powerful views on top of them.

### Key Features

<FeatureStatus>
- **Table View** âœ… Available - Spreadsheet-like display with inline editing
- **YAML Frontmatter Properties** âœ… Available - Add metadata without leaving markdown
- **Advanced Filtering** âœ… Available - Complex queries with multiple operators
- **Multi-column Sorting** âœ… Available - Sort by multiple properties simultaneously
- **Inline Editing** âœ… Available - Click cells to edit properties directly
- **8 Property Types** âœ… Available - Text, number, date, select, tags, checkbox, URL, email
- **Export capabilities** âœ… Available - Export to CSV, JSON, Markdown
- **MCP Integration** âœ… Available - AI assistants can query and manipulate bases
- **Grouping** ðŸš§ Coming v1.4 - Group by any property with aggregations
- **Gallery & Calendar Views** ðŸš§ Coming v1.4 - Additional view types
- **Formula Support** ðŸš§ Coming v1.4 - Calculated fields and rollups
</FeatureStatus>

## Creating Bases

### New Base

Create a Base from scratch:

**Method 1: From Menu**
1. File â†’ New Base
2. Name your Base
3. Choose initial view type
4. Define source (folder, tag, or query)

**Method 2: From Folder**
1. Right-click folder
2. "Create Base from Folder"
3. Base auto-configured for folder

**Method 3: Command Palette**
1. Press `Cmd/Ctrl + P`
2. Type "new base"
3. Follow prompts

### Base Sources

Define what notes to include:

**Source Types:**
- **Folder:** All notes in folder
- **Tag:** All notes with tag
- **Query:** Custom filter query
- **Manual:** Manually selected notes

**Example Sources:**
```
Folder: /Projects/Active
Tag: #task
Query: tag:#project AND status:active
Manual: [[Note 1]], [[Note 2]], [[Note 3]]
```

### Base Templates

Start with pre-built Base templates:

**Available Templates:**
- Project tracker
- Task manager
- Book library
- Contact database
- Meeting notes
- Blog posts
- Recipe collection
- Habit tracker

---

## How Bases Work with Markdown

### YAML Frontmatter Properties

Bases read metadata from YAML frontmatter in your markdown files. Your notes remain standard markdown - no proprietary format!

**Example Note:**
```markdown
---
title: Build Landing Page
status: In Progress
priority: High
tags:
  - web
  - design
due_date: 2025-10-30
owner: John Doe
completed: false
---

# Build Landing Page

Your note content here...
```

**What Bases Do:**
1. **Scan** all markdown files in your workspace
2. **Extract** properties from YAML frontmatter
3. **Index** values for fast filtering and sorting
4. **Display** in table view with inline editing
5. **Auto-update** when files change

### Automatic Property Detection

Lokus automatically detects property types:

| YAML Format | Detected Type | Example |
|-------------|---------------|---------|
| `key: "value"` | Text | `title: "My Note"` |
| `key: 42` | Number | `score: 85` |
| `key: 2025-10-30` | Date | `due_date: 2025-10-30` |
| `key: ["a", "b"]` | Tags | `tags: ["work", "urgent"]` |
| `key: true` | Checkbox | `completed: true` |
| `key: "https://..."` | URL | `link: "https://site.com"` |
| `key: "user@..."` | Email | `contact: "john@email.com"` |

### Inline Editing

Edit properties directly in the table view:

**How it works:**
1. **Click any cell** in the table
2. **Edit the value** (dropdown for select, date picker for dates, etc.)
3. **Press Enter** or click away
4. **Auto-saves** to the markdown file's frontmatter after 300ms

**Behind the scenes:**
```markdown
Before:  status: Todo
After:   status: In Progress  â† Updated in YAML automatically
```

The entire note content remains unchanged - only the frontmatter property is updated!

## View Types

### Table View

Spreadsheet-like view of your data:

**Features:**
- Sortable columns
- Resizable columns
- Freeze columns
- Cell editing
- Row selection
- Column hiding
- Column reordering

**Table Display:**
```
| Title          | Status | Due Date   | Priority | Assignee |
|----------------|--------|------------|----------|----------|
| Design mockups | Doing  | 2024-03-20 | High     | Sarah    |
| Write tests    | Todo   | 2024-03-22 | Medium   | John     |
| Deploy feature | Todo   | 2024-03-25 | High     | Mike     |
```

**Interactions:**
- Click cell to edit
- Drag column border to resize
- Click header to sort
- Right-click for options

![Database Table View with Properties](/placeholder.svg)

### Card View

Visual card-based layout:

**Features:**
- Customizable card size
- Image previews
- Property display control
- Multi-column layout
- Drag to reorder

**Card Elements:**
- Cover image (optional)
- Title
- Selected properties
- Tags/labels
- Preview text

**Use Cases:**
- Project boards
- Product catalogs
- Gallery views
- Contact cards

### Gallery View

Image-focused view:

**Features:**
- Large image thumbnails
- Hover for details
- Lightbox on click
- Adjustable image size
- Grid or masonry layout

**Display Options:**
- Image property to display
- Aspect ratio (square, 16:9, 4:3, original)
- Images per row
- Show captions
- Show metadata

![Database Views - Card, Gallery, and Calendar](/placeholder.svg)

**Best For:**
- Photo collections
- Design portfolios
- Product galleries
- Visual research

### List View

Compact list display:

**Features:**
- Dense information display
- Hierarchical grouping
- Expandable rows
- Quick actions
- Keyboard navigation

**List Configuration:**
- Primary field (title)
- Secondary field (subtitle)
- Tertiary field (metadata)
- Icon/thumbnail
- Action buttons

**Grouping:**
- Group by property
- Nested groups
- Expand/collapse all
- Group headers

### Calendar View

Time-based visualization:

**Features:**
- Month/week/day views
- Drag to reschedule
- Multi-day events
- Color coding
- Event popups

**Calendar Properties:**
- Date field (required)
- End date field (optional)
- All-day toggle
- Color property
- Display properties

**Use Cases:**
- Event planning
- Content calendar
- Project timeline
- Meeting schedule

### Kanban View

Workflow visualization:

**Features:**
- Customizable columns
- Drag between columns
- WIP limits
- Swim lanes
- Card customization

**Kanban Configuration:**
- Column property (status, stage, etc.)
- Column order
- Column limits
- Card properties to show
- Swim lane grouping

**Example:**
```
Backlog     Todo        Doing       Review      Done
-------     ----        -----       ------      ----
Task A      Task B      Task C      Task D      Task E
Task F      Task G      Task H      Task I      Task J
```

## Properties

### Property Types

Define custom fields for your data:

**Basic Types:**
- **Text:** Single-line text
- **Long Text:** Multi-line text (markdown)
- **Number:** Numeric values
- **Checkbox:** True/false
- **Date:** Date picker
- **Select:** Single choice dropdown
- **Multi-select:** Multiple choice

**Advanced Types:**
- **URL:** Validated URLs
- **Email:** Email addresses
- **Phone:** Phone numbers
- **File:** File attachments
- **Relation:** Link to other Base entries
- **Rollup:** Aggregate related data
- **Formula:** Calculated values

### Creating Properties

Add properties to Base:

**Steps:**
1. Click "+" in property header
2. Name the property
3. Choose type
4. Configure options
5. Set default value (optional)

**Property Configuration:**
```markdown
Property: Status
Type: Select
Options:
  - Backlog (gray)
  - Todo (blue)
  - In Progress (yellow)
  - Review (purple)
  - Done (green)
  - Cancelled (red)
Default: Backlog
```

### Property Options

Configure property behavior:

**Common Options:**
- Name and description
- Type and validation
- Default value
- Required field
- Show in views
- Color coding

**Type-Specific Options:**

**Number:**
- Format (integer, decimal, percentage, currency)
- Min/max values
- Precision
- Prefix/suffix

**Date:**
- Include time
- Date format
- Time format
- Relative display

**Select:**
- Options list
- Colors
- Allow new options
- Sort order

### Formula Properties

Calculate values from other properties:

**Formula Syntax:**
```javascript
// Simple calculation
{Price} * {Quantity}

// Conditional
if({Status} = "Done", "âœ“", "â—‹")

// Date difference
dateDiff({Due Date}, now(), "days")

// Text manipulation
upper(substring({Title}, 0, 10))

// Aggregation
sum({Related Tasks.Hours})
```

**Available Functions:**
- Math: `add`, `subtract`, `multiply`, `divide`, `round`, `abs`
- Logic: `if`, `and`, `or`, `not`
- Text: `concat`, `upper`, `lower`, `substring`, `length`
- Date: `now`, `today`, `dateDiff`, `dateAdd`, `formatDate`
- Aggregation: `sum`, `average`, `min`, `max`, `count`

### Rollup Properties

Aggregate related data:

**Rollup Configuration:**
1. Create relation property
2. Create rollup property
3. Select relation to follow
4. Choose property to aggregate
5. Select aggregation function

**Example:**
```
Projects Base â†’ Tasks Base relation

In Projects:
- Rollup: Total Hours
- Relation: Tasks
- Property: Estimated Hours
- Function: Sum

Result: Sum of all related task hours
```

## Relations

### Creating Relations

Link entries between Bases:

**Relation Types:**
- **One-to-One:** Single related entry
- **One-to-Many:** Multiple related entries
- **Many-to-Many:** Multiple on both sides

**Creating Relation:**
1. Add Relation property
2. Select target Base
3. Configure relationship
4. Optional: Create reverse relation

**Example Relations:**
- Projects â†’ Tasks (one-to-many)
- Tasks â†’ Person (many-to-one)
- Notes â†’ Tags (many-to-many)

### Linked Records

View and manage relations:

**Features:**
- Click to view related record
- Add new related records
- Remove relations
- Filter related records
- Sort related records

**Display:**
```markdown
## Project: Website Redesign

Related Tasks: [3]
- [Todo] Design homepage
- [Doing] Setup repository
- [Todo] Write documentation

Team Members: [2]
- Sarah (Designer)
- John (Developer)
```

### Reverse Relations

Automatic back-references:

**Configuration:**
- Enable reverse relation
- Name reverse property
- Appears in related Base
- Auto-maintained

**Example:**
```
Projects Base:
- Property: Tasks (Relation â†’ Tasks Base)

Tasks Base:
- Property: Project (auto-created reverse relation)
```

## Filtering

### Filter Types

Lokus Bases v1.3 supports comprehensive filtering with multiple operator types.

**Text Operators:**
```
equals           - Exact match (case-sensitive)
not_equals       - Not equal
contains         - Contains substring
not_contains     - Doesn't contain substring
starts_with      - Starts with text
ends_with        - Ends with text
is_empty         - No value or empty string
is_not_empty     - Has a value
matches_regex    - Regular expression match
```

**Number Operators:**
```
equals                  - Equal to
not_equals              - Not equal to
greater_than            - >
greater_than_or_equal   - >=
less_than               - <
less_than_or_equal      - <=
between                 - Between two values (inclusive)
```

**Date Operators:**
```
equals           - Exact date match
before           - Before date
after            - After date
between          - Between two dates
relative         - Relative to today:
  - last 7 days
  - last 30 days
  - this week
  - this month
  - next week
  - next month
is_empty         - No date set
is_not_empty     - Has a date
```

**Array Operators (Tags):**
```
contains_any     - Contains any of the specified values
contains_all     - Contains all specified values
is_empty         - Empty array or no tags
is_not_empty     - Has at least one tag
```

**Boolean (Checkbox) Operators:**
```
is_true          - Value is true
is_false         - Value is false
is_empty         - No value set
```

### Filter Groups

Combine multiple filters:

**Operators:**
- AND: All conditions must be true
- OR: Any condition must be true
- NOT: Invert condition

**Example:**
```
Show entries where:
  Status = "Active"
  AND (
    Priority = "High"
    OR Due Date < Today
  )
  AND Assignee is not empty
```

### Saved Filters

Save and reuse filters:

**Creating Saved Filters:**
1. Configure filters
2. Click "Save Filter"
3. Name the filter
4. Set as default (optional)

**Pre-built Filters:**
- Active items
- Completed items
- Overdue items
- Assigned to me
- Unassigned
- This week

## Sorting

### Sort Options

Order entries by properties:

**Sort Configuration:**
- Primary sort property
- Sort direction (ascending/descending)
- Secondary sort property
- Tertiary sort property

**Sort Types:**
- Alphabetical (A-Z or Z-A)
- Numeric (0-9 or 9-0)
- Date (earliest-latest or latest-earliest)
- Custom (manual order)

**Example:**
```
Sort by:
1. Priority (High to Low)
2. Due Date (Earliest to Latest)
3. Title (A to Z)
```

### Manual Sorting

Custom order with drag-and-drop:

**Features:**
- Drag rows to reorder
- Persists across sessions
- Override automatic sorting
- Reset to automatic sort

## Grouping

### Group By Property

Organize entries into groups:

**Grouping Options:**
- Group by any property
- Multi-level grouping
- Expand/collapse groups
- Group headers with counts
- Custom group order

**Example:**
```
Group by: Status
â”œâ”€ Backlog (5)
â”‚  â”œâ”€ Task A
â”‚  â””â”€ Task B
â”œâ”€ In Progress (3)
â”‚  â”œâ”€ Task C
â”‚  â””â”€ Task D
â””â”€ Done (12)
   â””â”€ Task E
```

### Group Aggregations

Show statistics per group:

**Aggregation Types:**
- Count
- Sum
- Average
- Min/Max
- Percentage

**Display:**
```
Status: In Progress (3 items, 15 hours total)
Status: Done (12 items, 48 hours total, avg 4 hours)
```

## Templates

### Entry Templates

Create consistent entries:

**Template Fields:**
- Pre-filled property values
- Default content
- Placeholders
- Auto-generated values

**Example Template:**
```markdown
---
template: project
status: planning
priority: medium
---

# {{title}}

## Overview
{{description}}

## Goals
- Goal 1
- Goal 2

## Tasks
- [ ] Initial task 1
- [ ] Initial task 2

## Timeline
Start: {{start_date}}
End: {{due_date}}
```

### Template Variables

Dynamic template content:

**Available Variables:**
- `{{now}}` - Current timestamp
- `{{today}}` - Today's date
- `{{user}}` - Current user
- `{{title}}` - Entry title
- `{{property_name}}` - Any property value

## Aggregations

### Summary Statistics

View aggregate data:

**Statistics:**
- Count of entries
- Sum of numeric fields
- Average values
- Min/Max values
- Median
- Standard deviation

**Display:**
```
Total Projects: 24
Active: 8
Completed: 12
On Hold: 4

Total Budget: $125,000
Average Budget: $5,208
Highest Budget: $25,000
```

### Charts and Visualizations

Visual data representation:

**Chart Types:**
- Bar chart
- Pie chart
- Line chart
- Scatter plot
- Timeline
- Heatmap

**Configuration:**
- X-axis property
- Y-axis property
- Grouping
- Aggregation function
- Colors

## Export and Import

### Export Options

Export Base data:

**Formats:**
- **CSV:** Spreadsheet compatible
- **JSON:** Structured data
- **Markdown:** Notes format
- **HTML:** Web display

**Export Settings:**
- Include all properties
- Filter before export
- Include relations
- Formatting options

### Import Data

Bring data into Bases:

**Import Sources:**
- CSV files
- JSON files
- Existing notes
- External databases

**Import Process:**
1. Choose import source
2. Map columns to properties
3. Preview import
4. Configure options
5. Import data

**Import Options:**
- Create new entries
- Update existing entries
- Skip duplicates
- Auto-create properties

## Collaboration

### Shared Bases

Collaborate on Bases:

**Features:**
- Real-time updates
- Multi-user editing
- Permissions control
- Activity history
- Comments per entry

**Permissions:**
- View only
- Comment
- Edit
- Admin

### Comments and Discussion

Discuss entries:

**Comment Features:**
- Per-entry comments
- Thread discussions
- @mentions
- File attachments
- Edit history

## Performance

### Optimization

Lokus Bases are optimized for large workspaces with thousands of notes.

**Performance Techniques:**
- **Lazy loading** - Load visible rows only
- **Virtual scrolling** - Render only visible table area
- **Indexed properties** - Pre-indexed for fast lookups
- **Cached aggregations** - Results cached for instant display
- **Progressive rendering** - Render table incrementally
- **Quantum Search** - Optional 100x faster indexing system

**Performance Benchmarks (v1.3):**
- **10,000+ entries** supported smoothly
- **Complex queries** execute under 100ms
- **Real-time updates** reflect under 50ms
- **Inline editing** saves in <300ms
- **Initial load** <2 seconds for 1,000 notes

### Quantum Search Integration

Enable Quantum Search for dramatically improved performance on large workspaces:

**How to Enable:**
1. Preferences â†’ Performance
2. Toggle "Enable Quantum Search"
3. Restart Lokus
4. Bases automatically use quantum indexing

**Performance Improvements:**
- **100x faster** search on 10,000+ files
- **O(1) lookup** complexity for property queries
- **90% less memory** usage during queries
- **Sub-millisecond** filter application
- **Predictive caching** for frequently-used queries

**Recommended for:**
- Workspaces with 5,000+ notes
- Complex multi-filter queries
- Real-time collaboration scenarios
- Users experiencing lag in Bases

### Large Workspace Tips

**For workspaces with 1,000+ notes:**

1. **Use specific source folders**
   ```yaml
   sourceFolder: "/projects"  # Specific folder
   # Not:  "/"  # Entire workspace (slower)
   ```

2. **Add exclude patterns**
   ```yaml
   exclude:
     - "archive/**"
     - ".lokus/**"
     - "node_modules/**"
     - "large-media/**"
   ```

3. **Limit default view**
   ```yaml
   views:
     - name: "Recent"
       filters:
         - property: "modified_date"
           operator: "after"
           value: "{{today-30d}}"
   ```

4. **Close unused Bases tabs**
   - Each open Base uses memory for indexing
   - Close tabs you're not actively using

5. **Enable Quantum Search** (see above)

## Configuration

### Base Settings

Configure Base behavior:

**General:**
- Base name
- Description
- Icon
- Source configuration
- Default view

**Properties:**
- Add/edit/delete properties
- Property order
- Visibility
- Validation rules

**Views:**
- Create/edit views
- View permissions
- Default view
- View layout

**Permissions:**
- Who can view
- Who can edit
- Who can admin
- Public access

## MCP Integration

### AI Assistant Integration

Lokus Bases integrate with the Model Context Protocol (MCP) server, allowing AI assistants to query and manipulate your bases programmatically.

**Available MCP Tools:**

#### `search_base`
Query a base with filters and sorting:
```javascript
{
  "tool": "search_base",
  "arguments": {
    "base": "projects",
    "query": "status:Active AND priority:High",
    "sort": "due_date ASC",
    "limit": 20
  }
}
```

#### `create_base_view`
Create a saved view in a base:
```javascript
{
  "tool": "create_base_view",
  "arguments": {
    "base": "projects",
    "name": "Urgent Tasks",
    "filters": [
      {
        "property": "status",
        "operator": "equals",
        "value": "In Progress"
      },
      {
        "property": "priority",
        "operator": "equals",
        "value": "High"
      }
    ],
    "sortBy": "due_date",
    "sortOrder": "asc"
  }
}
```

#### `update_base_property`
Update a property value in a note via Base:
```javascript
{
  "tool": "update_base_property",
  "arguments": {
    "base": "projects",
    "file": "project-a.md",
    "property": "status",
    "value": "Done"
  }
}
```

#### `export_base`
Export base data:
```javascript
{
  "tool": "export_base",
  "arguments": {
    "base": "projects",
    "format": "csv",
    "includeFilters": true
  }
}
```

### Example AI Workflows

**1. Find overdue tasks:**
```
User: "Show me all overdue high-priority tasks"

AI uses MCP:
search_base({
  base: "tasks",
  query: "due_date < today() AND priority:High AND status:!Done"
})
```

**2. Bulk status update:**
```
User: "Mark all completed tasks in the design project as done"

AI uses MCP:
1. search_base to find matching tasks
2. Loop and update_base_property for each
```

**3. Generate report:**
```
User: "Create a summary of active projects by owner"

AI uses MCP:
1. search_base with filters
2. Group results by owner
3. Generate markdown report
```

### MCP Setup

The MCP server starts automatically with Lokus - no configuration needed!

**Verify MCP Status:**
- Check status bar at bottom: "MCP: Running" (green)
- Or use: Preferences â†’ MCP Server â†’ Status

**Learn More:**
- [MCP Integration Guide](/developers/mcp/overview)
- [MCP Tools Reference](/reference/mcp-api)
- [AI Integration Examples](/developers/mcp/examples)

---

## Use Cases

### Project Management

Track projects with Bases:

**Properties:**
- Project name
- Status (select)
- Priority (select)
- Start date
- Due date
- Budget (number)
- Team members (relation)
- Tasks (relation)
- Progress (formula)

**Views:**
- Table: All projects overview
- Kanban: By status
- Calendar: By timeline
- Card: Visual grid

### Content Management

Manage blog posts, articles:

**Properties:**
- Title
- Author (relation)
- Status (draft, review, published)
- Publish date
- Categories (multi-select)
- Tags (multi-select)
- Word count (number)
- Featured image (file)

**Views:**
- Table: Editorial calendar
- Calendar: Publishing schedule
- Gallery: Featured posts
- List: By category

### CRM (Contacts)

Customer relationship management:

**Properties:**
- Name
- Company
- Email
- Phone
- Status (select)
- Last contact (date)
- Next follow-up (date)
- Notes (long text)
- Related deals (relation)

**Views:**
- Table: All contacts
- Card: Contact cards
- Kanban: By status
- Calendar: Follow-up schedule

### Inventory Management

Track items and assets:

**Properties:**
- Item name
- SKU
- Category
- Quantity (number)
- Location
- Status (in stock, low, out)
- Cost (number)
- Supplier (relation)
- Last ordered (date)

**Views:**
- Table: Full inventory
- List: By category
- Gallery: Product images
- Chart: Stock levels

## Best Practices

### Base Design

**Effective Bases:**
- Clear naming conventions
- Logical property structure
- Appropriate property types
- Consistent data entry
- Regular maintenance

**Property Guidelines:**
- Required fields first
- Group related properties
- Use templates for consistency
- Validate data entry
- Document property meanings

### Performance Tips

**Optimization:**
- Limit visible properties
- Use filters to reduce entries
- Archive completed items
- Optimize formulas
- Use relations wisely

## Troubleshooting

### Common Issues

**Issue:** Base loading slowly
**Solution:** Reduce visible entries, optimize formulas, check filters

**Issue:** Relations not working
**Solution:** Verify target Base exists, check permissions, rebuild index

**Issue:** Formula errors
**Solution:** Check syntax, verify property names, test incrementally

**Issue:** Import failed
**Solution:** Verify CSV format, check property types, review error log

## Next Steps

- Use [Templates](/features/templates) for Base entry templates
- Integrate with [Tasks](/features/tasks) for task management
- Explore [Search](/features/search) for Base queries
- See [Developer Guide](/developers) for Base API